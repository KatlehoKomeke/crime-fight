<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
        <style> @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@900&display=swap'); </style>
    </head>
    <body>
        <div id="loader" class="loader">
            <!-- <div class="circle left-circle"></div>
            <div class="circle right-circle"></div> -->
            Loading...
        </div>
        <div class="noise">
            <div id="navbar" class="noselect">cart<p id="cart-count"></p></div>
            <div id="main-page">
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('bullet proof vest')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('bullet proof vest')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('bullet proof vest')" src="./images/vest.png" alt="bullet proof vest">
                    <p class="noselect" onclick="moveToSecondPage('bullet proof vest')">bullet proof vest</p>
                </div>
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('tazer')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('tazer')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('tazer')" src="./images/tazer.png" alt="tazer">
                    <p class="noselect" onclick="moveToSecondPage('tazer')">tazer</p>
                </div>
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('airtag')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('airtag')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('airtag')" src="./images/airtag.png" alt="airtag">
                    <p class="noselect" onclick="moveToSecondPage('airtag')">airtag</p>
                </div>
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('cctv')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('cctv')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('cctv')" src="./images/cctv.png" alt="cctv">
                    <p class="noselect" onclick="moveToSecondPage('cctv')">cctv</p>
                </div>
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('pepper spray')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('pepper spray')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('pepper spray')" src="./images/pepper.png" alt="pepper spray">
                    <p class="noselect" onclick="moveToSecondPage('pepper spray')">pepper spray</p>
                </div>
                <div class="blob-container">
                    <svg width="200%" height="200%" viewBox="0 0 340 364" fill="grey" xmlns="http://www.w3.org/2000/svg">
                        <g filter="url(#filter0_f_67_9)" onclick="moveToSecondPage('pad lock')">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M165.651 19.0215C234.46 17.7939 288.807 69.1911 310.412 131.471C332.413 194.892 321.336 266.944 265.783 307.666C205.561 351.811 119.557 359.887 59.7808 315.194C4.96468 274.209 14.192 199.212 36.6609 136.355C57.8527 77.0707 99.9534 20.1937 165.651 19.0215Z" fill="url(#paint0_linear_67_9)"/>
                        </g>
                        <defs onclick="moveToSecondPage('pad lock')">
                            <filter id="filter0_f_67_9" x="0" y="0" width="340" height="364" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
                                <feGaussianBlur stdDeviation="9.5" result="effect1_foregroundBlur_67_9"/>
                            </filter>
                            <linearGradient id="paint0_linear_67_9" x1="170" y1="19" x2="170" y2="345" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C4C4C4"/>
                                <stop offset="1" stop-color="#C4C4C4" stop-opacity="0"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <img class="product noselect" onclick="moveToSecondPage('pad lock')" src="./images/lock.png" alt="lock">
                    <p class="noselect" onclick="moveToSecondPage('pad lock')">pad lock</p>
                </div>
            </div>
            <div id="secondary-page"></div>
            <div id="shopping-cart-page"></div>
            <div id="payment-page"></div>
        </div>
        
        <script src="https://www.paypal.com/sdk/js?client-id=AecgjzD_UeBG05hYZ_NOddvk5LOVQ1s2EvzyCh_rpOrYvbY7Ky73Ns5-CQSTHd-nj2JOtBnmEqggtMeE&enable-funding=venmo&currency=USD" data-sdk-integration-source="button-factory"></script>
        <script>
            
            window.addEventListener("load", async function() {
                if(localStorage.getItem('cart')){
                    document.getElementById("cart-count").textContent = JSON.parse(localStorage.getItem('cart')).length;
                }
                generateNoise(0.2);
                document.getElementById("main-page").style.display = "grid";
                document.getElementById("navbar").style.display = "block";
                document.getElementById("loader").style.display = "none";
            });
            
            function generateNoise(opacity,truthy,noiseElement) {
                if(!document.createElement('canvas').getContext){
                    return false;
                }
                var canvas = document.createElement('canvas'),
                    ctx = canvas.getContext('2d'),
                    x,y,
                    r,g,b,
                    opacity = opacity;

                    canvas.width = 4000;
                    canvas.height = 4000;

                    for (x = 0; x < canvas.width; x++){
                        for (y = 0; y < canvas.height; y++){
                            const greyScale = Math.floor(Math.random() * 100) + 100;
                            if(greyScale < 157){
                                ctx.fillStyle = 'rgba(' + 0 + ',' + 0 + ',' + 0 + ',' + opacity + ')';
                                ctx.fillRect(x,y,greyScale%3,greyScale%3);
                            }
                        }
                    }
                    document.getElementsByClassName('noise')[0].style.backgroundImage = "url(" + canvas.toDataURL("image/png") + ")";
            }
            
            function moveToSecondPage(nameOfProduct){
                document.getElementById("main-page").style.display = "none";
                document.getElementById("secondary-page").style.display = "grid";

                var child = document.getElementById("secondary-page").lastElementChild; 
                while (child) {
                    document.getElementById("secondary-page").removeChild(child);
                    child = document.getElementById("secondary-page").lastElementChild;
                }
                
                if(localStorage.getItem('cart')){
                    document.getElementById("cart-count").textContent = JSON.parse(localStorage.getItem('cart')).length;
                }
                const blobContainer_addToCart = document.createElement('div');
                blobContainer_addToCart.className = "blob-container_add-to-cart";
                const blobContainer = document.createElement('div');
                blobContainer.className = "blob-container";
                const blob = document.createElement('div');
                blob.className = "blob";
                const productNoselect = document.createElement('img');
                productNoselect.className = "product noselect";
                productNoselect.alt = nameOfProduct;
                const productName_noselect = document.createElement('p');
                const addToCart_noselect = document.createElement('div');
                addToCart_noselect.className = "add-to-cart noselect";
                addToCart_noselect.textContent = "add to cart";
                const layerBlur_optionalSize = document.createElement('div');
                layerBlur_optionalSize.className = "layer-blur_optional-size";
                const layerBlur = document.createElement('div');
                layerBlur.className = "layer-blur";
                const blob2 = document.createElement('div');
                blob2.className = "blob";
                layerBlur.append(blob2);
                const textForPurchaser = document.createElement('div');
                textForPurchaser.className = "text-for-purchaser";
                const price = document.createElement('p');
                const rating = document.createElement('p');
                const description = document.createElement('p');

                const optionalSize = document.createElement('div');
                optionalSize.className = "optional-size";
                const noselect1 = document.createElement('div');
                noselect1.className = "noselect";
                noselect1.textContent = "small";
                const noselect2 = document.createElement('div');
                noselect2.className = "noselect";
                noselect2.textContent = "medium";
                const noselect3 = document.createElement('div');
                noselect3.className = "noselect";
                noselect3.textContent = "large";

                switch(nameOfProduct){
                    case "bullet proof vest":
                        productNoselect.src = "./images/vest.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('bullet proof vest');
                        });
                        optionalSize.append(noselect1);
                        optionalSize.append(noselect2);
                        optionalSize.append(noselect3);
                        price.textContent = "price: $350";
                        rating.textContent = "rating: 5";
                        description.textContent = "description: (DOES NOT INCLUDE CERAMIC PLATES!) State of the art,lightweight, ergonomic and comfortable. Protects against .9mm, .357, 44 magnum rounds and blunt force trauma.";
                        break;
                    case "tazer":
                        productNoselect.src = "./images/tazer.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('tazer');
                        });
                        price.textContent = "price: $50";
                        rating.textContent = "rating: 5";
                        description.textContent = "PROFESSIONAL DEFENSE EQUIPMENT DESIGNED TO DEFEND: Deliver Painful Stopping Power! Heavy Duty Super Powerful Stun Gun With Snatch Prevention. INTERNAL RECHARGEABLE BATTERY: Recharge cord (included) plugs into a standard wall outlet to save you money on batteries.";
                        break;
                    case "airtag":
                        productNoselect.src = "./images/airtag.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('airtag');
                        });
                        price.textContent = "price: $70";
                        rating.textContent = "rating: 5";
                        description.textContent = "AirTag is a super-easy way to keep track of your stuff. Attach one to your keys, slip another in your backpack. And just like that, they’re on your radar in the Find My app, where you can also track down your Apple devices and keep up with friends and family.";
                        break;
                    case "cctv":
                        productNoselect.src = "./images/cctv.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('cctv');
                        });
                        price.textContent = "price: $330";
                        rating.textContent = "rating: 5";
                        description.textContent = "Hikvision 8 Channel Turbo DVR with 1TB HDD & 8 Cameras DIY CCTV Kit. Remote viewing via Hik-Connect app which can be downloaded from Google Store / Apple Store.";
                        break;
                    case "pepper spray":
                        productNoselect.src = "./images/pepper.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('pepper spray');
                        });
                        price.textContent = "price: $50";
                        rating.textContent = "rating: 5";
                        description.textContent = "Self Defense Pepper Spray 60ml. Only use when in danger. If sprayed on the face, rinse with plenty of water.";
                        break;
                    case "pad lock":
                        productNoselect.src = "./images/lock.png";
                        addToCart_noselect.addEventListener('click', ()=>{
                            updateCart('pad lock');
                        });
                        price.textContent = "price: $50";
                        rating.textContent = "rating: 5";
                        description.textContent = "The shackle is manufactured from case hardened steel and is protected in a stainless steel body.";
                        break;
                }
                blobContainer.append(blob);
                blobContainer.append(productNoselect);
                blobContainer.append(productName_noselect);

                textForPurchaser.append(price);
                textForPurchaser.append(rating);
                textForPurchaser.append(description);

                layerBlur.append(textForPurchaser);
                layerBlur_optionalSize.append(layerBlur);
                layerBlur_optionalSize.append(optionalSize);

                blobContainer_addToCart.append(blobContainer);
                blobContainer_addToCart.append(addToCart_noselect);
                document.getElementById("secondary-page").append(blobContainer_addToCart);
                document.getElementById("secondary-page").append(layerBlur_optionalSize);    
            }
            function setCartIsEmpty(){
                if(JSON.parse(localStorage.getItem('cart')).length === 0){
                    const emptyCart = document.createElement("p");
                    emptyCart.textContent = "Your cart is empty, please add items to cart.";
                    document.getElementById("shopping-cart-page").append(emptyCart);
                }
            }
            function cartDisplayHelper(nameOfProduct,size,index){
                const shoppingCartRow = document.createElement("div");
                shoppingCartRow.className = "shopping-cart-row";
                const blobContainer = document.createElement("div");
                blobContainer.className = "blob-container";
                const blob = document.createElement("div");
                blob.className = "blob";
                const product_noselect = document.createElement("img");
                product_noselect.className = "product noselect";
                product_noselect.alt = nameOfProduct;
                switch(nameOfProduct){
                    case "bullet proof vest":
                        product_noselect.src = "./images/vest.png";
                        break;
                    case "tazer":
                        product_noselect.src = "./images/tazer.png";
                        break;
                    case "airtag":
                        product_noselect.src = "./images/airtag.png";
                        break;
                    case "cctv":
                        product_noselect.src = "./images/cctv.png";
                        break;
                    case "pepper spray":
                        product_noselect.src = "./images/pepper.png";
                        break;
                    case "pad lock":
                        product_noselect.src = "./images/lock.png";
                        break;
                }
                blobContainer.append(blob);
                blobContainer.append(product_noselect);
                const center_noselect1 = document.createElement("p");
                center_noselect1.className = "center noselect";
                if(size){
                    center_noselect1.textContent = size;
                }else{
                    switch(nameOfProduct){
                        case "bullet proof vest":
                            center_noselect1.textContent = "medium";
                            break;
                        case "tazer":
                            center_noselect1.textContent = "n/a";
                            break;
                        case "airtag":
                            center_noselect1.textContent = "n/a";
                            break;
                        case "cctv":
                            center_noselect1.textContent = "n/a";
                            break;
                        case "pepper spray":
                            center_noselect1.textContent = "n/a";
                        break;
                        case "pad lock":
                            center_noselect1.textContent = "n/a";
                        break;
                    } 
                }
                const center_noselect2 = document.createElement("p");
                center_noselect2.className = "center noselect";
                center_noselect2.textContent = nameOfProduct;
                const dollarCost_center_noselect = document.createElement("p");
                dollarCost_center_noselect.className = "dollar-cost center noselect";
                
                switch(nameOfProduct){
                    case "bullet proof vest":
                        dollarCost_center_noselect.textContent = "$350";
                        break;
                    case "tazer":
                        dollarCost_center_noselect.textContent = "$50";
                        break;
                    case "airtag":
                        dollarCost_center_noselect.textContent = "$70";
                        break;
                    case "cctv":
                        dollarCost_center_noselect.textContent = "$330";
                        break;
                    case "pepper spray":
                        dollarCost_center_noselect.textContent = "$50";
                        break;
                    case "pad lock":
                        dollarCost_center_noselect.textContent = "$50";
                        break;
                }

                const trashCan = document.createElement("img");
                trashCan.src = "./images/trash.png";
                trashCan.className = "trash";
                trashCan.alt = "trash";
                trashCan.addEventListener("click", ()=>{
                    let tmp_array = JSON.parse(localStorage.getItem('cart'));
                    tmp_array.splice(index, 1);
                    localStorage.setItem('cart',JSON.stringify(tmp_array));
                    var child = document.getElementById("shopping-cart-page").lastElementChild; 
                    while (child) {
                        document.getElementById("shopping-cart-page").removeChild(child);
                        child = document.getElementById("shopping-cart-page").lastElementChild;
                    }
                    const cart = JSON.parse(localStorage.getItem('cart'));
                    cart.forEach((productName,index)=>{
                        cartDisplayHelper(productName,null,index)
                    });
                    setCartIsEmpty();
                    addShoppingCartFooter()
                });

                shoppingCartRow.append(blobContainer);
                shoppingCartRow.append(center_noselect1);
                shoppingCartRow.append(center_noselect2);
                shoppingCartRow.append(dollarCost_center_noselect);
                shoppingCartRow.append(trashCan);
    
                document.getElementById("shopping-cart-page").append(shoppingCartRow);
            }
            function calculateTotal(){
                let total = 0;
                JSON.parse(localStorage.getItem('cart')).forEach((item)=>{
                    switch(item){
                        case 'bullet proof vest':
                            total += 350;
                            break;
                        case 'tazer':
                            total += 50;
                            break;
                        case 'airtag':
                            total += 70;
                            break;
                        case 'cctv':
                            total += 330;
                            break;
                        case 'pepper spray':
                            total += 50;
                            break;
                        case 'pad lock':
                            total += 50;
                            break;
                    }
                })
                return total;
            }
            function addShoppingCartFooter(){
                const totalSum = document.createElement("div");
                totalSum.className = "total-sum";
                const noselect1 = document.createElement("div");
                noselect1.className = "noselect";
                noselect1.textContent = "total: $" + calculateTotal();
                const noselect2 = document.createElement("div");
                noselect2.className = "noselect";
                noselect2.textContent = "buy now";
                noselect2.addEventListener('click', ()=>{
                    document.getElementById("main-page").style.display = "none";
                    document.getElementById("secondary-page").style.display = "none";
                    document.getElementById("shopping-cart-page").style.display = "none";
                    document.getElementById("payment-page").style.display = "grid";
                    initPayPalButton();
                });
                totalSum.append(noselect1);
                totalSum.append(noselect2);
                document.getElementById("shopping-cart-page").append(totalSum);
            }

            document.getElementById("navbar").addEventListener("click",function(event){
                const cartCount = document.createElement("p");
                switch(this.textContent.substring(0,4)){
                    case "cart":
                        this.textContent = "home";
                        document.getElementById("main-page").style.display = "none";
                        document.getElementById("secondary-page").style.display = "none";
                        document.getElementById("shopping-cart-page").style.display = "grid";
                        var child = document.getElementById("shopping-cart-page").lastElementChild; 
                        while (child) {
                            document.getElementById("shopping-cart-page").removeChild(child);
                            child = document.getElementById("shopping-cart-page").lastElementChild;
                        }
                        const cart = JSON.parse(localStorage.getItem('cart'));
                        cart.forEach((productName,index)=>{
                            cartDisplayHelper(productName,null,index);
                        });
                        setCartIsEmpty();
                        addShoppingCartFooter();
                        break;
                    case "home":
                        this.textContent = "cart";
                        cartCount.id = "cart-count";
                        this.append(cartCount);
                        document.getElementById("main-page").style.display = "grid";
                        document.getElementById("secondary-page").style.display = "none";
                        document.getElementById("shopping-cart-page").style.display = "none";
                        if(localStorage.getItem('cart')){
                            document.getElementById("cart-count").textContent = JSON.parse(localStorage.getItem('cart')).length;
                        }
                        var child = document.getElementById("payment-page").lastElementChild; 
                        while (child) {
                            document.getElementById("payment-page").removeChild(child);
                            child = document.getElementById("payment-page").lastElementChild;
                        }
                        break;
                    default:
                        console.warn("no match");
                        console.warn("this.textContent: ",this.textContent);
                }
            });
            function updateCart(addToCart,RemoveFromCart){
                if(!addToCart && !RemoveFromCart){
                    return ;
                }
                if(addToCart){
                    const cart_string = localStorage.getItem('cart');
                    if(cart_string){
                        const cart_array = JSON.parse(cart_string);
                        cart_array.push(addToCart);
                        localStorage.setItem('cart',JSON.stringify(cart_array));
                    }else{
                        const cart = [];
                        cart.push(addToCart);
                        localStorage.setItem('cart',JSON.stringify(cart));
                    } 
                    if(localStorage.getItem('cart')){
                        document.getElementById("cart-count").textContent = JSON.parse(localStorage.getItem('cart')).length;
                    }
                }
                if(RemoveFromCart){
                    const cart_string = localStorage.getItem('cart');
                    if(cart_string){
                        const cart_array = JSON.parse(cart_string);
                        const index = cart_array.indexOf(RemoveFromCart);
                        if (index > -1) { // only splice array when item is found
                            cart_array.splice(index, 1); // 2nd parameter means remove one item only
                        }
                    }
                }
            }

            function priceOfProduct(nameOfProduct){
                switch(nameOfProduct){
                    case 'bullet proof vest':
                        return 350;
                        break;
                    case 'tazer':
                        return 50;
                        break;
                    case 'airtag':
                        return 70;
                        break;
                    case 'cctv':
                        return 330;
                        break;
                    case 'pepper spray':
                        return 50;
                        break;
                    case 'pad lock':
                        return 50;
                        break;
                }
            }
            function countInstanancesOfElement(nameOfProduct){
                let count = 0;
                const cart = JSON.parse(localStorage.getItem('cart'));
                for (let i = 0; i < cart.length; i++) {
                    // if entity is object, increase objectsLen by 1, which is the stores the total number of objects in array.
                    if (cart[i] === nameOfProduct) {
                        count++;
                    }
                }
                return count;
            }
            function generatePaymentItenArray(){
                const cart = JSON.parse(localStorage.getItem('cart'));
                const cart_array = [];
                cart.forEach((productName,index)=>{
                    cart_array.push({
                        name: productName,
                        unit_amount: {
                            currency_code: 'USD',
                            value: priceOfProduct(productName)
                        },
                        quantity: countInstanancesOfElement(productName)
                    });
                });
                console.log(cart_array);
                return cart_array;
            }
            function initPayPalButton() {
                var child = document.getElementById("payment-page").lastElementChild; 
                while (child) {
                    document.getElementById("payment-page").removeChild(child);
                    child = document.getElementById("payment-page").lastElementChild;
                }
                const smartButtonContainer = document.createElement("div");
                smartButtonContainer.id = "smart-button-container";
                const div = document.createElement("div");
                div.style = "text-align: center;";
                const paypalButtonContainer = document.createElement("div");
                paypalButtonContainer.id = "paypal-button-container";
                div.append(paypalButtonContainer);
                smartButtonContainer.append(div);
                document.getElementById("payment-page").append(smartButtonContainer);

                paypal.Buttons({
                    style: {
                        shape: 'pill',
                        color: 'black',
                        layout: 'vertical',
                        label: 'buynow', 
                    },
            
                    createOrder: function(data, actions) {
                        return actions.order.create({
                        // purchase_units: [{amount:{currency_code:"USD",value:1}}]
                            purchase_units: [{
                                description: "the_description",
                                amount: {
                                    currency_code: 'USD',
                                    value: calculateTotal(),
                                    breakdown: {
                                        item_total: {
                                            currency_code: 'USD',
                                            value: calculateTotal(),
                                        },
                                        shipping: {
                                            currency_code: 'USD',
                                            value: 0,
                                        },
                                        tax_total: {
                                            currency_code: 'USD',
                                            value: 0,
                                        }
                                    }
                                },
                                items: generatePaymentItenArray()
                            }]
                        });
                    },
            
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(orderData) {
                        
                        // Full available details
                        console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
            
                        // Show a success message within this page, e.g.
                        const element = document.getElementById('paypal-button-container');
                        element.innerHTML = '';
                        element.innerHTML = '<h3>Thank you for your payment!</h3>';
            
                        // Or go to another URL:  actions.redirect('thank_you.html');
                        
                        });
                    },
            
                    onError: function(err) {
                        console.log(err);
                    }
                }).render('#paypal-button-container');
            }
        </script>
    </body>
</html>